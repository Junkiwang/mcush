source [find interface/cmsis-dap.cfg]

#reset_config trst_and_srst separate trst_push_pull srst_push_pull
#adapter_nsrst_assert_width  1000
#adapter_nsrst_delay  1000
#reset_config trst_only trst_push_pull
reset_config none

transport select swd
#transport select jtag

set CHIPNAME lpc4337
set WORKAREASIZE 0x8000
source [find target/lpc4350.cfg]

#targets $CHIPNAME.m4
if { [using_jtag] } {
    targets $CHIPNAME.m0
}

targets


$CHIPNAME.m4 configure -work-area-phys 0x20000000 -work-area-size $WORKAREASIZE
if { [using_jtag] } {
    $CHIPNAME.m0 configure -work-area-phys 0x20000000 -work-area-size $WORKAREASIZE
} 

flash bank flash_a lpc2000 0x1a000000 0x80000 0 0 $CHIPNAME.m4 lpc4300 204000 calc_checksum
if { [using_jtag] } {
    flash bank flash_b lpc2000 0x1b000000 0x80000 0 0 $CHIPNAME.m0 lpc4300 204000 calc_checksum
} else {
    flash bank flash_b lpc2000 0x1b000000 0x80000 0 0 $CHIPNAME.m4 lpc4300 204000 calc_checksum
}

adapter_khz 5000

#$CHIPNAME.m4 configure -rtos auto

